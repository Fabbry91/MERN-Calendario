{"ast":null,"code":"import _regeneratorRuntime from\"/home/fabbry/Desktop/Mern-Calendari/calendar-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fabbry/Desktop/Mern-Calendari/calendar-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{fetchSinToken,fetchConToken}from'../helpers/fetch';import{types}from'../types/types';import Swal from'sweetalert2';import{eventLogout}from'./events';export var startLogin=function startLogin(email,password){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var resp,body;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchSinToken('auth',{email:email,password:password},'POST');case 2:resp=_context.sent;_context.next=5;return resp.json();case 5:body=_context.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{Swal.fire('Error',body.msg,'error');}case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var startRegister=function startRegister(email,password,name){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var resp,body;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchSinToken('auth/new',{email:email,password:password,name:name},'POST');case 2:resp=_context2.sent;_context2.next=5;return resp.json();case 5:body=_context2.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{Swal.fire('Error',body.msg,'error');}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var startChecking=function startChecking(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var resp,body;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchConToken('auth/renew');case 2:resp=_context3.sent;_context3.next=5;return resp.json();case 5:body=_context3.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{dispatch(checkingFinish());}case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var checkingFinish=function checkingFinish(){return{type:types.authCheckingFinish};};var login=function login(user){return{type:types.authLogin,payload:user};};export var startLogout=function startLogout(){return function(dispatch){localStorage.clear();dispatch(eventLogout());dispatch(logout());};};var logout=function logout(){return{type:types.authLogout};};","map":{"version":3,"sources":["/home/fabbry/Desktop/Mern-Calendari/calendar-app/src/actions/auth.js"],"names":["fetchSinToken","fetchConToken","types","Swal","eventLogout","startLogin","email","password","dispatch","resp","json","body","ok","localStorage","setItem","token","Date","getTime","login","uid","name","fire","msg","startRegister","startChecking","checkingFinish","type","authCheckingFinish","user","authLogin","payload","startLogout","clear","logout","authLogout"],"mappings":"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","sourcesContent":["import { fetchSinToken, fetchConToken } from '../helpers/fetch';\nimport { types } from '../types/types';\nimport Swal from 'sweetalert2';\nimport { eventLogout } from './events';\n\n\n\nexport const startLogin = ( email, password ) => {\n    return async( dispatch ) => {\n\n        const resp = await fetchSinToken( 'auth', { email, password }, 'POST' );\n        const body = await resp.json();\n\n        if( body.ok ) {\n            localStorage.setItem('token', body.token );\n            localStorage.setItem('token-init-date', new Date().getTime() );\n\n            dispatch( login({\n                uid: body.uid,\n                name: body.name\n            }) )\n        } else {\n            Swal.fire('Error', body.msg, 'error');\n        }\n        \n\n    }\n}\n\nexport const startRegister = ( email, password, name ) => {\n    return async( dispatch ) => {\n\n        const resp = await fetchSinToken( 'auth/new', { email, password, name }, 'POST' );\n        const body = await resp.json();\n\n        if( body.ok ) {\n            localStorage.setItem('token', body.token );\n            localStorage.setItem('token-init-date', new Date().getTime() );\n\n            dispatch( login({\n                uid: body.uid,\n                name: body.name\n            }) )\n        } else {\n            Swal.fire('Error', body.msg, 'error');\n        }\n\n\n    }\n}\n\nexport const startChecking = () => {\n    return async(dispatch) => {\n\n        const resp = await fetchConToken( 'auth/renew' );\n        const body = await resp.json();\n\n        if( body.ok ) {\n            localStorage.setItem('token', body.token );\n            localStorage.setItem('token-init-date', new Date().getTime() );\n\n            dispatch( login({\n                uid: body.uid,\n                name: body.name\n            }) )\n        } else {\n            dispatch( checkingFinish() );\n        }\n    }\n}\n\nconst checkingFinish = () => ({ type: types.authCheckingFinish });\n\n\n\nconst login = ( user ) => ({\n    type: types.authLogin,\n    payload: user\n});\n\n\nexport const startLogout = () => {\n    return ( dispatch ) => {\n\n        localStorage.clear();\n        dispatch( eventLogout() );\n        dispatch( logout() );\n    }\n}\n\nconst logout = () => ({ type: types.authLogout })"]},"metadata":{},"sourceType":"module"}